(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[187],{9626:function(e,t,s){"use strict";s.d(t,{Z:function(){return y}});var a=s(5893),n=s(7294),r=s(8028),c=s.n(r),l=s(6653),i=s(6409),o=s(3841),d=s(7058),x=s(9417),u=s(6761),m=s(5365),h=s(6808),f=s.n(h),j=s(2192),p=s(6451);function y(e){let{contract:t,refresh:s,close:r}=e,h=f().get("accessToken"),y=f().get("username"),[N,g]=(0,n.useState)(t.contract.text),[v,b]=(0,n.useState)(!1),[w,T]=(0,n.useState)(""),S=async()=>{let e;console.log("saving draft: ",N),e=void 0==t.contractId?await (0,p.EE)(y,t.partyB,N,h):await (0,p.JT)(t.contractId,N,y,h);let a="Success"==e.result?"success":"error";T(a),b(!0),t.contract.text=N,setTimeout(()=>{b(!1)},1500),"Success"==e.result&&s()};return(0,a.jsxs)("div",{className:"w-1/2 h-3/4 mx-auto my-auto bg-white rounded-lg shadow-md overflow-hidden border border-gray-200",children:[(0,a.jsx)("h2",{className:"mx-4 px-2 my-4 text-lg font-semibold text-gray-800",children:"Contratto Tra le parti"}),(0,a.jsx)("div",{id:"default-sidebar",className:"flex w-full px-3 py-4 bg-white",children:(0,a.jsxs)("ul",{className:"w-full mx-4 my-4 space-y-2 font-medium",children:[(0,a.jsx)("li",{className:"w-full",children:(0,a.jsxs)("div",{className:"flex w-full justify-between",children:[(0,a.jsx)("span",{className:"flex ".concat(c().className," text-[16px]"),children:"Nome richiedente"}),(0,a.jsx)("span",{className:"flex ".concat(c().className," text-[16px]"),children:t.partyA})]})}),(0,a.jsx)("hr",{class:"h-px my-8 bg-gray-200 border-0 dark:bg-gray-700"}),(0,a.jsx)("li",{className:"w-full",children:(0,a.jsxs)("div",{className:"flex w-full justify-between",children:[(0,a.jsx)("span",{className:"flex ".concat(c().className," text-[16px]"),children:"Nome proprietario logo"}),(0,a.jsx)("span",{className:"flex ".concat(c().className," text-[16px]"),children:t.partyB})]})}),void 0==t.contractId?null:(0,a.jsx)("hr",{class:"h-px my-8 bg-gray-200 border-0 dark:bg-gray-700"}),void 0==t.contractId?null:(0,a.jsx)("li",{className:"w-full",children:(0,a.jsxs)("div",{className:"flex w-full justify-between",children:[(0,a.jsx)("span",{className:"flex ".concat(c().className," text-[16px]"),children:"Esito richiedente"}),t.signs[t.partyA].sign?(0,a.jsx)("span",{className:"flex ".concat(c().className," text-[16px] text-green-500"),children:"Accepted"}):(0,a.jsx)("span",{className:"flex ".concat(c().className," text-[16px] text-red-500"),children:"Refused"})]})}),void 0==t.contractId?null:(0,a.jsx)("hr",{class:"h-px my-8 bg-gray-200 border-0 dark:bg-gray-700"}),void 0==t.contractId?null:(0,a.jsx)("li",{className:"w-full",children:(0,a.jsxs)("div",{className:"flex w-full justify-between",children:[(0,a.jsx)("span",{className:"flex ".concat(c().className," text-[16px]"),children:"Esito proprietario"}),t.signs[t.partyB].sign?(0,a.jsx)("span",{className:"flex ".concat(c().className," text-[16px] text-green-500"),children:"Accepted"}):(0,a.jsx)("span",{className:"flex ".concat(c().className," text-[16px] text-red-500"),children:"Refused"})]})})]})}),(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)(i.Z,{className:"w-full h-full",children:[(0,a.jsx)(o.Z,{htmlFor:"component-outlined",children:"Contratto"}),N==t.contract.text?null:(0,a.jsx)(l.Z,{color:"warning",badgeContent:" ",variant:"dot",className:"absolute -top-0 start-0"}),(0,a.jsx)(d.Z,{id:"component-outlined",defaultValue:N,multiline:!0,rows:10,label:"Name",className:"w-full",onChange:e=>g(e.target.value)})]}),(0,a.jsxs)("div",{className:"mt-4 flex justify-evenly",children:[(0,a.jsx)(x.Z,{className:"bg-color-[#00FF00]",variant:"outlined",startIcon:(0,a.jsx)(u.Z,{}),onClick:r,children:"Discard"}),(0,a.jsx)(x.Z,{className:"bg-color-[#00FF00]",disabled:N==t.contract.text,onClick:S,variant:"outlined",endIcon:(0,a.jsx)(m.Z,{}),children:"Send"})]}),(0,a.jsx)("div",{className:"flex my-auto mx-auto",children:v?(0,a.jsx)(j.Z,{severity:w}):null})]})]})}},2477:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});var a=s(5893),n=s(7294),r=s(7878),c=s(9626),l=s(1797);function i(e){let{contract:t,refresh:s}=e,[i,o]=n.useState(!1),d=()=>o(!1);return(0,a.jsxs)("div",{className:"flex w-full",children:[(0,a.jsx)(l.Z,{type:"button",className:"mx-auto cursor-pointer",onClick:()=>o(!0)}),(0,a.jsx)(r.Z,{open:i,onClose:d,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",className:"flex",children:(0,a.jsx)(c.Z,{contract:t,refresh:s,className:"mx-auto my-auto",close:d})})]})}},5073:function(e,t,s){"use strict";s.d(t,{e:function(){return b}});var a=s(5893),n=s(7294),r=s(2477),c=s(9653),l=s(9199);let i=l.mM.create({header:{fontSize:10,color:"gray",textAlign:"center",marginTop:10},title:{fontSize:24,textAlign:"center",marginTop:30,marginBottom:20,fontWeight:"bold"},divider:{borderBottom:"1px solid #ccc",marginVertical:10},sectionTitle:{fontSize:14,fontWeight:"bold",marginTop:20},sectionContent:{fontSize:12,marginBottom:20},bodyText:{fontSize:12,lineHeight:1.5,marginBottom:20},footer:{fontSize:10,textAlign:"center",position:"absolute",bottom:10,left:0,right:0}});function o(e){let{contract:t}=e;return(0,a.jsx)(l.BB,{children:(0,a.jsxs)(l.T3,{size:"A4",style:{padding:40},children:[(0,a.jsx)(l.xv,{style:i.header,children:"~ Created with Redfered ~"}),(0,a.jsx)(l.xv,{style:i.title,children:"Contract Agreement"}),(0,a.jsx)(l.xv,{style:i.divider}),(0,a.jsx)(l.xv,{style:i.sectionTitle,children:"Party A:"}),(0,a.jsx)(l.xv,{style:i.sectionContent,children:t.partyA}),(0,a.jsx)(l.xv,{style:i.sectionTitle,children:"Party B:"}),(0,a.jsx)(l.xv,{style:i.sectionContent,children:t.partyB}),(0,a.jsx)(l.xv,{style:i.divider}),(0,a.jsx)(l.xv,{style:i.bodyText,children:t.contract.text}),(0,a.jsx)(l.xv,{render:e=>{let{pageNumber:t,totalPages:s}=e;return"Page ".concat(t," of ").concat(s)},style:i.footer})]})})}var d=s(7878),x=s(4854);function u(e){let{contract:t}=e,[s,r]=n.useState(!1);return(0,a.jsxs)("div",{children:[(0,a.jsx)(x.Z,{onClick:()=>r(!0)}),(0,a.jsx)(d.Z,{open:s,onClose:()=>r(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:(0,a.jsx)(l.Z$,{className:"w-4/5 h-4/5",children:(0,a.jsx)(o,{contract:t,className:"w-full h-full"})})})]})}var m=s(6761),h=s(2026),f=s(5537),j=s(6808),p=s.n(j),y=s(2192),N=s(6451);function g(e){let{item:t,refresh:s}=e,l=p().get("accessToken"),i=p().get("username"),o=new Date(1e3*t.signs[t.partyA].ts),d=t.partyA==i?t.partyB:t.partyA,[x,j]=(0,n.useState)(!1),[g,v]=(0,n.useState)(""),b=async()=>{let e=await (0,N.Vm)(t.contractId,l),a="Success"==e.result?"success":"error";v(a),"Success"==e.result&&(s("pool_users"),s("user_contracts")),j(!0),setTimeout(()=>{j(!1)},1500)},w=async()=>{let e=await (0,N.NM)(t.contractId,i,!t.signs[i].sign,l),a="Success"==e.result?"success":"error";v(a),"Success"==e.result&&s("user_contracts"),j(!0),setTimeout(()=>{j(!1)},1500)};return(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"px-4 py-2 text-center",children:d}),(0,a.jsx)("td",{className:"px-4 py-2 text-center",children:t.partyA}),(0,a.jsx)("td",{className:"px-4 py-2",children:(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsx)(c.Z,{checked:t.signs[i].sign,onClick:w})})}),(0,a.jsx)("td",{className:"px-4 py-2",children:(0,a.jsx)("div",{className:"flex justify-center",children:t.signs[d].sign?(0,a.jsx)(h.Z,{}):(0,a.jsx)(f.Z,{})})}),(0,a.jsx)("td",{className:"px-4 py-2 text-center",children:o.toUTCString()}),(0,a.jsx)("td",{className:"px-4 py-2",children:(0,a.jsx)(r.Z,{contract:t,refresh:s})}),(0,a.jsx)("td",{className:"px-4 py-2",children:(0,a.jsx)("div",{className:"flex justify-center cursor-pointer",children:(0,a.jsx)(u,{contract:t})})}),(0,a.jsx)("td",{className:"px-4 py-2",children:(0,a.jsx)("div",{className:"flex justify-center cursor-pointer",children:(0,a.jsx)(m.Z,{type:"button",color:"error",onClick:b})})}),(0,a.jsx)("div",{className:"flex mx-auto",children:x?(0,a.jsx)(y.Z,{severity:g}):null})]})}let v="px-4 py-2 text-center";function b(e){let{data:t,refresh:s}=e;if(null!==t)return(0,a.jsx)("div",{className:"my-4 mx-4 h-1/2 bg-white rounded-lg",children:(0,a.jsxs)("table",{className:"table-auto",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:v,children:"Partner"}),(0,a.jsx)("th",{className:v,children:"Inviata da"}),(0,a.jsx)("th",{className:v,children:"La mia firma"}),(0,a.jsx)("th",{className:v,children:"Firma del partner"}),(0,a.jsx)("th",{className:v,children:"Ultimo aggiornamento"}),(0,a.jsx)("th",{className:v,children:"Modifica"}),(0,a.jsx)("th",{className:v,children:"Scarica"}),(0,a.jsx)("th",{className:v,children:"Elimina"})]})}),(0,a.jsx)("tbody",{children:void 0==t?null:t.map(e=>(0,a.jsx)(g,{item:e,refresh:s}))})]})})}},2192:function(e,t,s){"use strict";s.d(t,{Z:function(){return c}});var a=s(5893),n=s(5568),r=s(2026);function c(e){let{severity:t}=e;return(console.log("severity =",t),"error"!==t&"success"!==t)?null:(0,a.jsx)(n.Z,{icon:(0,a.jsx)(r.Z,{fontSize:"inherit"}),severity:t,className:"fixed top-0 mx-auto",children:"success"==t?"Contratto salvato!":"Error"})}},6451:function(e,t,s){"use strict";s.d(t,{EE:function(){return l},JT:function(){return o},NM:function(){return i},Vm:function(){return d},dV:function(){return c},fo:function(){return r},gk:function(){return n}});var a=s(6567);async function n(e){let t=await fetch(a.T5+"/invitationcode?code="+e),s=await t.json();return s}async function r(e,t){let s=await fetch(a.T5+"/contract?contractId="+e,{method:"GET",mode:"cors",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t}}),n=await s.json();return n.contract}async function c(e){let t=await fetch(a.T5+"/img_url",{method:"GET",mode:"cors",headers:{"Content-Type":"application/json",Authorization:"Bearer "+e}}),s=await t.json();return s.img_url}async function l(e,t,s,n){let r=await fetch(a.T5+"/add_new_contract_item",{method:"POST",mode:"cors",headers:{"Content-Type":"application/json",Authorization:"Bearer "+n},body:JSON.stringify({partyA:e,partyB:t,text:s})}),c=await r.json();return c}async function i(e,t,s,n){let r=await fetch(a.T5+"/update_sign",{method:"POST",mode:"cors",headers:{"Content-Type":"application/json",Authorization:"Bearer "+n},body:JSON.stringify({contractId:e,user:t,sign:s})}),c=await r.json();return c}async function o(e,t,s,n){let r=await fetch(a.T5+"/update_contract_text",{method:"POST",mode:"cors",headers:{"Content-Type":"application/json",Authorization:"Bearer "+n},body:JSON.stringify({contractId:e,text:t,user:s})}),c=await r.json();return c}async function d(e,t){let s=await fetch(a.T5+"/delete_contract_item",{method:"POST",mode:"cors",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t},body:JSON.stringify({contractId:e})}),n=await s.json();return n}},2480:function(){}}]);