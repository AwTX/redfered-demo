(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[53],{8652:function(e,t,a){"use strict";a.d(t,{Z:function(){return ContractCard}});var s=a(5893),n=a(7294),c=a(8671),r=a.n(c),l=a(6653),i=a(6409),o=a(3841),d=a(7058),u=a(9417),x=a(7141),m=a(5365),h=a(6808),p=a.n(h),f=a(2949),j=a(892);function ContractCard(e){let{contract:t,refresh:a,close:c}=e,h=p().get("accessToken"),y=p().get("username"),[g,N]=(0,n.useState)(t.contractText),[_,b]=(0,n.useState)(!1),[v,w]=(0,n.useState)(""),send=async()=>{let e;console.log("saving draft: ",g),e=void 0==t.contractId?await (0,j.EE)(y,t.partyB,g,h):await (0,j.JT)(t.contractId,g,y,h);let s="Success"==e.result?"success":"error";w(s),b(!0),t.contractText=g,setTimeout(()=>{b(!1)},1500),"Success"==e.result&&(a("pool_users"),a("user_contracts"))};return(0,s.jsxs)("div",{className:"w-1/2 h-3/4 mx-auto my-auto bg-white rounded-lg shadow-md overflow-hidden border border-gray-200",children:[(0,s.jsx)("h2",{className:"mx-4 px-2 my-4 text-lg font-semibold text-gray-800",children:"Contratto Tra le parti"}),(0,s.jsx)("div",{id:"default-sidebar",className:"flex w-full px-3 py-4 bg-white",children:(0,s.jsxs)("ul",{className:"w-full mx-4 my-4 space-y-2 font-medium",children:[(0,s.jsx)("li",{className:"w-full",children:(0,s.jsxs)("div",{className:"flex w-full justify-between",children:[(0,s.jsx)("span",{className:"flex ".concat(r().className," text-[16px]"),children:"Nome richiedente"}),(0,s.jsx)("span",{className:"flex ".concat(r().className," text-[16px]"),children:t.partyA})]})}),(0,s.jsx)("hr",{class:"h-px my-8 bg-gray-200 border-0 dark:bg-gray-700"}),(0,s.jsx)("li",{className:"w-full",children:(0,s.jsxs)("div",{className:"flex w-full justify-between",children:[(0,s.jsx)("span",{className:"flex ".concat(r().className," text-[16px]"),children:"Nome proprietario logo"}),(0,s.jsx)("span",{className:"flex ".concat(r().className," text-[16px]"),children:t.partyB})]})}),void 0==t.contractId?null:(0,s.jsx)("hr",{class:"h-px my-8 bg-gray-200 border-0 dark:bg-gray-700"}),void 0==t.contractId?null:(0,s.jsx)("li",{className:"w-full",children:(0,s.jsxs)("div",{className:"flex w-full justify-between",children:[(0,s.jsx)("span",{className:"flex ".concat(r().className," text-[16px]"),children:"Esito richiedente"}),"true"==t.partyASign?(0,s.jsx)("span",{className:"flex ".concat(r().className," text-[16px] text-green-500"),children:"Accepted"}):(0,s.jsx)("span",{className:"flex ".concat(r().className," text-[16px] text-red-500"),children:"Refused"})]})}),void 0==t.contractId?null:(0,s.jsx)("hr",{class:"h-px my-8 bg-gray-200 border-0 dark:bg-gray-700"}),void 0==t.contractId?null:(0,s.jsx)("li",{className:"w-full",children:(0,s.jsxs)("div",{className:"flex w-full justify-between",children:[(0,s.jsx)("span",{className:"flex ".concat(r().className," text-[16px]"),children:"Esito proprietario"}),"true"==t.partyBSign?(0,s.jsx)("span",{className:"flex ".concat(r().className," text-[16px] text-green-500"),children:"Accepted"}):(0,s.jsx)("span",{className:"flex ".concat(r().className," text-[16px] text-red-500"),children:"Refused"})]})})]})}),(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsxs)(i.Z,{className:"w-full h-full",children:[(0,s.jsx)(o.Z,{htmlFor:"component-outlined",children:"Contratto"}),g==t.contractText?null:(0,s.jsx)(l.Z,{color:"warning",badgeContent:" ",variant:"dot",className:"absolute -top-0 start-0"}),(0,s.jsx)(d.Z,{id:"component-outlined",defaultValue:g,multiline:!0,rows:10,label:"Name",className:"w-full",onChange:e=>N(e.target.value)})]}),(0,s.jsxs)("div",{className:"mt-4 flex justify-evenly",children:[(0,s.jsx)(u.Z,{className:"bg-color-[#00FF00]",variant:"outlined",startIcon:(0,s.jsx)(x.Z,{}),onClick:c,children:"Discard"}),(0,s.jsx)(u.Z,{className:"bg-color-[#00FF00]",disabled:g==t.contractText,onClick:send,variant:"outlined",endIcon:(0,s.jsx)(m.Z,{}),children:"Send"})]}),(0,s.jsx)("div",{className:"flex my-auto mx-auto",children:_?(0,s.jsx)(f.Z,{severity:v}):null})]})]})}},41:function(e,t,a){"use strict";a.d(t,{Z:function(){return ContractModal}});var s=a(5893),n=a(7294),c=a(7878),r=a(8652),l=a(1797);function ContractModal(e){let{contract:t,refresh:a}=e,[i,o]=n.useState(!1),handleClose=()=>o(!1);return(0,s.jsxs)("div",{className:"flex w-full",children:[(0,s.jsx)(l.Z,{type:"button",className:"mx-auto cursor-pointer",onClick:()=>o(!0)}),(0,s.jsx)(c.Z,{open:i,onClose:handleClose,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",className:"flex",children:(0,s.jsx)(r.Z,{contract:t,refresh:a,className:"mx-auto my-auto",close:handleClose})})]})}},3478:function(e,t,a){"use strict";a.d(t,{e:function(){return ContractsTable}});var s=a(5893),n=a(7294),c=a(41),r=a(9653),l=a(7376);let i=l.mM.create({header:{fontSize:10,color:"gray",textAlign:"center",marginTop:10},title:{fontSize:24,textAlign:"center",marginTop:30,marginBottom:20,fontWeight:"bold"},divider:{borderBottom:"1px solid #ccc",marginVertical:10},sectionTitle:{fontSize:14,fontWeight:"bold",marginTop:20},sectionContent:{fontSize:12,marginBottom:20},bodyText:{fontSize:12,lineHeight:1.5,marginBottom:20},footer:{fontSize:10,textAlign:"center",position:"absolute",bottom:10,left:0,right:0}});function ContractPdf(e){let{contract:t}=e;return(0,s.jsx)(l.BB,{children:(0,s.jsxs)(l.T3,{size:"A4",style:{padding:40},children:[(0,s.jsx)(l.xv,{style:i.header,children:"~ Created with Redfered ~"}),(0,s.jsx)(l.xv,{style:i.title,children:"Contract Agreement"}),(0,s.jsx)(l.xv,{style:i.divider}),(0,s.jsx)(l.xv,{style:i.sectionTitle,children:"Party A:"}),(0,s.jsx)(l.xv,{style:i.sectionContent,children:t.partyA}),(0,s.jsx)(l.xv,{style:i.sectionTitle,children:"Party B:"}),(0,s.jsx)(l.xv,{style:i.sectionContent,children:t.partyB}),(0,s.jsx)(l.xv,{style:i.divider}),(0,s.jsx)(l.xv,{style:i.bodyText,children:t.contractText}),(0,s.jsx)(l.xv,{render:e=>{let{pageNumber:t,totalPages:a}=e;return"Page ".concat(t," of ").concat(a)},style:i.footer})]})})}var o=a(7878),d=a(2249);function PdfModal(e){let{contract:t}=e,[a,c]=n.useState(!1);return(0,s.jsxs)("div",{children:[(0,s.jsx)(d.Z,{onClick:()=>c(!0)}),(0,s.jsx)(o.Z,{open:a,onClose:()=>c(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:(0,s.jsx)(l.Z$,{className:"w-4/5 h-4/5",children:(0,s.jsx)(ContractPdf,{contract:t,className:"w-full h-full"})})})]})}var u=a(7141),x=a(2026),m=a(5537),h=a(6808),p=a.n(h),f=a(2949),j=a(892);function ContractsTableRow(e){let{item:t,refresh:a}=e,l=p().get("accessToken"),i=p().get("username");console.log("[ContractsTableRow] item: ",t);let o=new Date(1e3*t.ts),d=t.partyA==i?t.partyB:t.partyA,[h,y]=(0,n.useState)(!1),[g,N]=(0,n.useState)("");function mySign(){if(void 0!=t)return t.partyA==i?t.partyASign:t.partyBSign}let deleteItem=async()=>{let e=await (0,j.Vm)(t.contractId,l),s="Success"==e.result?"success":"error";N(s),"Success"==e.result&&(a("pool_users"),a("user_contracts")),y(!0),setTimeout(()=>{y(!1)},1500)},signItem=async()=>{let e="true"==mySign()?"false":"true",s=await (0,j.NM)(t.contractId,i,e,l),n="Success"==s.result?"success":"error";N(n),"Success"==s.result&&a("user_contracts"),y(!0),setTimeout(()=>{y(!1)},1500)};return(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"px-4 py-2 text-center",children:d}),(0,s.jsx)("td",{className:"px-4 py-2",children:(0,s.jsx)("div",{className:"flex justify-center",children:"true"==function(){if(void 0!=t)return t.partyA==i?t.partyBSign:t.partyASign}()?(0,s.jsx)(x.Z,{}):(0,s.jsx)(m.Z,{})})}),(0,s.jsx)("td",{className:"px-4 py-2",children:(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsx)(r.Z,{checked:"true"==mySign(),onClick:signItem})})}),(0,s.jsx)("td",{className:"px-4 py-2 text-center",children:o.toUTCString()}),(0,s.jsx)("td",{className:"px-4 py-2",children:(0,s.jsx)(c.Z,{contract:t,refresh:a})}),(0,s.jsx)("td",{className:"px-4 py-2",children:(0,s.jsx)("div",{className:"flex justify-center cursor-pointer",children:(0,s.jsx)(PdfModal,{contract:t})})}),(0,s.jsx)("td",{className:"px-4 py-2",children:(0,s.jsx)("div",{className:"flex justify-center cursor-pointer",children:(0,s.jsx)(u.Z,{type:"button",color:"error",onClick:deleteItem})})}),(0,s.jsx)("div",{className:"flex mx-auto",children:h?(0,s.jsx)(f.Z,{severity:g}):null})]})}let y="px-4 py-2 text-center whitespace-nowrap overflow-hidden text-ellipsis";function ContractsTable(e){let{data:t,refresh:a}=e;if(null!==t)return(0,s.jsx)("div",{className:"bg-transparent",children:(0,s.jsxs)("table",{className:"table-auto mx-auto my-4 shadow-lg shadow-blue-500 rounded-lg",children:[(0,s.jsx)("thead",{className:"shadow",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:y,children:"Partner"}),(0,s.jsx)("th",{className:y,children:"Firma del partner"}),(0,s.jsx)("th",{className:y,children:"La mia firma"}),(0,s.jsx)("th",{className:y,children:"Ultimo aggiornamento"}),(0,s.jsx)("th",{className:y,children:"Modifica"}),(0,s.jsx)("th",{className:y,children:"Scarica"}),(0,s.jsx)("th",{className:y,children:"Elimina"})]})}),(0,s.jsx)("tbody",{children:void 0==t?null:t.map(e=>(0,s.jsx)(ContractsTableRow,{item:e,refresh:a},"ContractsTableRowKey"))})]})})}},2949:function(e,t,a){"use strict";a.d(t,{Z:function(){return SimpleAlert}});var s=a(5893),n=a(5568),c=a(2026);function SimpleAlert(e){let{severity:t}=e;return(console.log("severity =",t),"error"!==t&"success"!==t)?null:(0,s.jsx)(n.Z,{icon:(0,s.jsx)(c.Z,{fontSize:"inherit"}),severity:t,className:"fixed top-0 mx-auto",children:"success"==t?"Contratto salvato!":"Error"})}},892:function(e,t,a){"use strict";a.d(t,{EE:function(){return call_api_add_new_contract_item},JT:function(){return call_api_update_contract_text},NM:function(){return call_api_update_sign},Vm:function(){return call_api_delete_contract},dV:function(){return call_api_get_img_url},fo:function(){return call_api_get_contract},gk:function(){return call_api_submitInvitationCode}});var s=a(1002);async function call_api_submitInvitationCode(e){let t=await fetch(s.T5+"/invitationcode?code="+e),a=await t.json();return a}async function call_api_get_contract(e,t){let a=await fetch(s.T5+"/contract?contractId="+e,{method:"GET",mode:"cors",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t}}),n=await a.json();return n.contract}async function call_api_get_img_url(e){let t=await fetch(s.T5+"/logos",{method:"GET",mode:"cors",headers:{"Content-Type":"application/json",Authorization:"Bearer "+e}}),a=await t.json();return a.logos}async function call_api_add_new_contract_item(e,t,a,n){let c=await fetch(s.T5+"/add_new_contract_item",{method:"POST",mode:"cors",headers:{"Content-Type":"application/json",Authorization:"Bearer "+n},body:JSON.stringify({partyA:e,partyB:t,text:a})}),r=await c.json();return r}async function call_api_update_sign(e,t,a,n){let c=await fetch(s.T5+"/update_sign",{method:"POST",mode:"cors",headers:{"Content-Type":"application/json",Authorization:"Bearer "+n},body:JSON.stringify({contractId:e,user:t,sign:a})}),r=await c.json();return r}async function call_api_update_contract_text(e,t,a,n){let c=await fetch(s.T5+"/update_contract_text",{method:"POST",mode:"cors",headers:{"Content-Type":"application/json",Authorization:"Bearer "+n},body:JSON.stringify({contractId:e,text:t,user:a})}),r=await c.json();return r}async function call_api_delete_contract(e,t){let a=await fetch(s.T5+"/delete_contract_item",{method:"POST",mode:"cors",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t},body:JSON.stringify({contractId:e})}),n=await a.json();return n}},2480:function(){}}]);